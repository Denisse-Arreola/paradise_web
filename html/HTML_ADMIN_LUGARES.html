

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Paradise - Administrador</title>
    <link rel="stylesheet" href="../css/cssBase.css" />

    <script src="../js/dialog.js"></script>
    
</head>


<body onload="loadOptionsEsp();">
    <header>
        <!--Encabezado-->
        Titulo

    </header>

    <section class="sectionPrincipal">
    
        <article id="barAdmin">
            <table class="upBar">

                <tr>

                    <td> <button onclick="turnOnPnlConsult()">Consultar</button> </td>
                    <td>  <button onclick="turnOnPnlAdd()">Registrar</button>  </td>
                    <td>  <button onclick="turnOnPnlModify()">Modificar</button>  </td>

                </tr>



            </table>

        </article>


        <nav>
            Lista de opciones (Puede estar escondida.) <br />


            <ul>

                <li>
                    <a >Esquemas (Opción predefinida)</a>
                </li>

                <li>
                    <a>Reservaciones</a>
                </li>

                <li>
                    <a href="HTML_ADMIN_AGENTES.html">Agentes</a>
                </li>

                <li>
                    <a href="HTML_ADMIN_LUGARES.html">Lugares</a>

                    <ol>
                        Provedores
                    </ol>
                    <ol>
                        Municipios
                    </ol>
                </li>

                <li>
                    <a>Clientes</a>
                </li>

            </ul>
        </nav>



        <article id="artMain">


            <section class="consultPanel" id="pnlConsult" style="display:Block">
                <section class='searchForm'>
                    <input type='search' placeholder='B&uacute;squeda de lugares.'  id='id_lugar'>
                    <input type='button' value='Buscar' onclick="buscarLugar(true)" id="btnM" style="display:none">
                    <input type='button' value='Buscar' onclick="buscarLugar(false)" id="btnS" style="display:block">
                </section>               
            </section>

            <section class="addPanel" id="pnlAdd" style="display:none">
                <section class='registerSection' name='searchAdminForm'>

               

                        <label id="lblNum" style="display:none"> Número del Lugar:</label> <input id="tbNum" style="display:none" type="text" disabled><br />
                        Nombre del Lugar: <input type='text' id='txtNombreLugar' maxlength="30" autofocus required><br />
                        Costo del Lugar: <input type='number' id="txtCostoLugar"  /><br />
                        Capacidad del Lugar: <input type='number' id="txtCapacidadLugar" required /><br />
                        Descripción del Lugar: <input type='text' id="txtDescLugar" maxlength="120" />

                        <select id="CBCiudades" required>
                            <option value="TIJ">
                                Tijuana
                            </option>

                            <option value="ESE">
                                Ensenada
                            </option>

                            <option value="MXL">
                                Mexicali
                            </option>

                            <option value="ROS">
                                Rosarito
                            </option>

                            <option value="TEC">
                                Tecate
                            </option>

                        </select>

                        <section id="boxEsp"></section>
                        <hr  />
                        <button onclick="document.getElementById('intPnlDirection').style.display = 'block';
                                        document.getElementById('btnDwn').style.display = 'none';
                                        document.getElementById('btnUp').style.display = 'block';" 
                                id="btnDwn">
                            down
                             
                        </button> <!----Elemento tipo barra desplegable al momento del click desprender el resto del formulario.-->


                        <button onclick="document.getElementById('intPnlDirection').style.display = 'none';
                                        document.getElementById('btnDwn').style.display = 'block';
                                        document.getElementById('btnUp').style.display = 'none';" 
                                        style="display:none"
                                        id="btnUp">
                            up

                        </button>
                        <section style="display:none" id="intPnlDirection">
                            Calle: <input type='text' id='txtCalleDirec'><br />
                            Número interior: <input type='text' id='txtNumIntDirec'><br />
                            Número Exterior: <input type='number' id="txtNumExtDirec" /><br />
                            Código Postal: <input type='number' id="txtCP" /><br />                          
                        </section>

                        <input type="button" id="btnSend" style="float:right;display:block" value="Enviar" onclick="registrarLugar(true)" /> <br />
                        <input type="button" id="btnModify" style="float:right;display:none" value="Enviar" onclick="registrarLugar(false)" /> <br />
                 


                   

                   

                    <p id="msg">En proceso</p>

                </section>            
            </section>

            <section id="listLugar" style="display:none; width:100%;"></section>

        </article>
        
    </section>
    

    <script>

        

        function turnOnPnlConsult() {
            document.getElementById("listLugar").innerHTML = "";
            document.getElementById('pnlConsult').style.display = "block";
            document.getElementById('pnlAdd').style.display = "None";         
            document.getElementById("listLugar").style.display = "none";

            document.getElementById('btnM').style.display = "none";
            document.getElementById('btnS').style.display = "block";
        }


        function turnOnPnlAdd() {
            document.getElementById("listLugar").innerHTML = "";
            document.getElementById('pnlConsult').style.display = "None";
            document.getElementById('pnlAdd').style.display = "block";           
            document.getElementById("listLugar").style.display = "none";
            document.getElementById('intPnlDirection').style.display = 'none';
            document.getElementById('btnDwn').style.display = 'block';
            document.getElementById('btnUp').style.display = 'none';
            
        }

        function turnOnPnlModify() {
            document.getElementById("listLugar").innerHTML = "";
            document.getElementById('pnlConsult').style.display = "block";
            document.getElementById('pnlAdd').style.display = "None";        
            document.getElementById("listLugar").style.display = "none";            
            document.getElementById('btnM').style.display = "block";
            document.getElementById('btnS').style.display = "none";

            document.getElementById('intPnlDirection').style.display = 'none';
            document.getElementById('btnDwn').style.display = 'none';
            document.getElementById('btnUp').style.display = 'none';
        }

        function registrarLugar(res) {
            createDialog();
            document.getElementById("listLugar").innerHTML = "";

            var lugarOb = null;

            var CKS = document.getElementsByClassName("ckB");
            



        if (res==true){

               lugarOb = {
                nombre: document.getElementById("txtNombreLugar").value,
                desc: document.getElementById("txtDescLugar").value,
                costo: document.getElementById("txtCostoLugar").value,
                capacidad: document.getElementById("txtCapacidadLugar").value,
                estado: document.getElementById(),
                direc: new function () {
                     this.obDirec={
                        calle : document.getElementById("txtCalleDirec").value,
                        numIn : document.getElementById("txtNumIntDirec").value,
                        numEx : document.getElementById("txtNumExtDirec").value,
                        cp: document.getElementById("txtCP").value
                     }

                     if (this.obDirec.calle == "" || this.obDirec.numIn == "" || this.obDirec.cp == "") {
                         this.obDirec = false;
                    }                   
                },
                espacios: new function(){
                    var a=0;
                    this.arrayId=[];
                    while (CKS[a]) {                        
                        if (CKS[a].checked == true) {
                            this.arrayId.push(CKS[a].value);
                        }
                        a++;
                    }                    
                },
                type : true};
        } else {

               lugarOb = {
                numero :parseInt( document.getElementById("tbNum").value),
                nombre: document.getElementById("txtNombreLugar").value,
                desc: document.getElementById("txtDescLugar").value,
                costo: document.getElementById("txtCostoLugar").value,
                capacidad: document.getElementById("txtCapacidadLugar").value,
                //espacios: new function(){
                //    var a=0;
                //    this.values=[];
                //    while (CKS[a]) {                        
                //        if (CKS[a].checked == true) {
                //            this.values.push(CKS[a].value);
                //        }
                //        a++;
                //    }                    
                //},
                type : false
            };
        }
            
        console.log(lugarOb);

            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange= function () {
                if (ajax.readyState== 4 && ajax.status==200){
                    document.getElementById("msg").innerHTML = ajax.responseText;
                }
            };

            //ajax.open("GET", "../php/sendLugar.php?b="+JSON.stringify(lugarOb), true);
            ajax.open("GET", "../php/registerUpdateLugar.php?b=" + JSON.stringify(lugarOb), true);
            ajax.send();
        }


       

        function buscarLugar(res) {
            createDialog();
            document.getElementById("listLugar").innerHTML = "";


            var ajax = new XMLHttpRequest();

            var searchForm = null;

            if (res == true) {
                searchForm = {
                    search: document.getElementById("id_lugar").value,
                    type : true
                };
            } else {
                searchForm = {
                    search: document.getElementById("id_lugar").value,
                    type: false
                };
            }
            
            ajax.onreadystatechange = function () {
                if (ajax.readyState == 4 && ajax.status == 200) {
                    document.getElementById("listLugar").style.display = "block";
                    document.getElementById("listLugar").innerHTML = ajax.responseText;
                }
            };


            ajax.open("GET", "../php/busquedaLugar.php?b=" +JSON.stringify(searchForm), true);
            ajax.send();

        }

        function modifyLugar(a) {
            turnOnPnlAdd();
            document.getElementById("btnModify").style.display = "block";
            document.getElementById("btnSend").style.display = "none";                        



            document.getElementById("txtNombreLugar").value=a.nombre;
            document.getElementById("txtDescLugar").value = a.desc;
            document.getElementById("txtCostoLugar").value = a.costo;
            document.getElementById("txtCapacidadLugar").value = a.capacidad;


            document.getElementById("tbNum").style.display = "block";
            document.getElementById("lblNum").style.display = "block";
            document.getElementById("tbNum").value = a.numero;
            
        }

        function loadOptionsEsp() {

            var ajax = new XMLHttpRequest();

            ajax.onreadystatechange = function () {
                if (ajax.status == 200 && ajax.readyState == 4) {
                    fillOptionsEsp(ajax.responseText);
                }
            };

            ajax.open("get", "../php/loadEspacios.php?", true);
            ajax.send();

        }

        function fillOptionsEsp(ob) {
            var y=0;
            var arrayEspacios = JSON.parse(ob);

            var espSection = document.getElementById("boxEsp");

           

            while (arrayEspacios[y]) {

                var ckBox = document.createElement("input");
                ckBox.setAttribute("type", "checkbox");
                ckBox.setAttribute("class", "ckB");                
                ckBox.style.marginRight = "50px";

                ckBox.value = arrayEspacios[y].num;
                               
                var lbl = document.createElement("Label");
                lbl.innerHTML = arrayEspacios[y].nombre;

                espSection.appendChild(lbl);
                espSection.appendChild(ckBox);
                y ++;
                
            }                                    
        }


        function loadTiposLugar(){
            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange = function () {
                if (ajax.status == 200 && ajax.readyState == 4) {
                    fillOptionsPT(ajax.responseText);

                }
            }

            ajax.open("get", "../php/loadTipolugar.php?", true);
            ajax.send();
        }

        function fillOptionsPT(ob) {
            var arrayTipoLugar = JSON.parse(ob);
            
            var x = 0;

            while (arrayTipoLugar[x]) {                


            }


        }
    </script>



</body>
</html>