<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Paradise - Administrador</title>
    <link rel="stylesheet" href="../css/cssBase.css" />
</head>

<body>
    <header>

        <!--Encabezado-->
        Agentes

    </header>






    <section class="sectionPrincipal">

        <article id="barAdmin">
            <table class="upBar">

                <tr>

                    <td> <button onclick="turnOnPnlConsult()">Consultar</button> </td>
                    <td>  <button onclick="turnOnPnlAdd()">Registrar</button>  </td>
                    <td>  <button onclick="turnOnPnlModify()">Modificar</button>  </td>

                </tr>



            </table>

        </article>


        <nav>
            Lista de opciones (Puede estar escondida.) <br />


            <ul>

                <li>
                    <a>Esquemas (Opción predefinida)</a>
                </li>

                <li>
                    <a>Reservaciones</a>
                </li>

                <li>
                    <a  href="HTML_ADMIN_AGENTES.html">Agentes</a>
                </li>

                <li>
                    <a href="HTML_ADMIN_LUGARES.html">Lugares</a>

                    <ol>
                        Provedores
                    </ol>
                    <ol>
                        Municipios
                    </ol>
                </li>

                <li>
                    <a>Clientes</a>
                </li>

            </ul>
        </nav>



        <article id="artMain">


            <section class="consultPanel" id="pnlConsult" style="display:Block">
                <section class='searchForm'>
                    <input type='search' placeholder='Búsqueda de Agente.' id='id_Agente'>
                    <input type='button' value='Buscar' onclick="buscarAgente()">
                </section>
            </section>

            <section class="addPanel" id="pnlAdd" style="display:none">
                <section class='registerSection' name='searchAdminForm'>
                    <label id="lblMatricula" style="display:none"> Matrícula del Agente:</label> <input id="tbNum" style="display:none" type="text" disabled><br />

                    Nombre del Agente: <input type='text' id='txtNombreAgente' maxlength="30" autofocus required><br />
                    Apellido paterno del Agente: <input type='text' id='txtApPatAgente' maxlength="20" required><br />
                    Apellido materno del Agente: <input type='text' id='txtApMatAgente' maxlength="20" ><br />
                    Genero: 
                    <select id="genreBox">                     
                        <option value="M">Masculino</option>
                        <option value="F">Femenino</option>
                    </select>

                    <br />
                    
                    Fecha de Nacimiento: <input type='date' id="dateNac" required /><br />

                    <input type="button" id="btnSend" style="float:right;display:block" value="Enviar" onclick="registrarAgente()" /> <br />

                    <input type="button" id="btnModify" style="float:right;display:none" value="Enviar" onclick="updateAgente()" /> <br />                 

                    <p id="msg">En proceso</p>

                </section>
            </section>

            <section class="modifyPanel" id="pnlModify" style="display:none">
                <section class='searchForm'>

                    <input type='search' placeholder='Búsqueda de Agentes. ' id="shcMod">
                    <button onclick="buscarAgenteM()">Buscar</button>

                </section>
            </section>

            <section id="listAgente" style="display:none; width:100%;"></section>
        </article>

    </section>


    <script>


        function turnOnPnlConsult() {
            document.getElementById("listAgente").innerHTML = "";
            document.getElementById('pnlConsult').style.display = "block";
            document.getElementById('pnlAdd').style.display = "None";
            document.getElementById('pnlModify').style.display = "None";
            document.getElementById("listAgente").style.display = "none";

        }


        function turnOnPnlAdd() {
            document.getElementById("listAgente").innerHTML = "";
            document.getElementById('pnlConsult').style.display = "None";
            document.getElementById('pnlAdd').style.display = "block";
            document.getElementById('pnlModify').style.display = "None";
            document.getElementById("listAgente").style.display = "none";

        }

        function turnOnPnlModify() {
            document.getElementById("listAgente").innerHTML = "";
            document.getElementById('pnlConsult').style.display = "None";
            document.getElementById('pnlAdd').style.display = "None";
            document.getElementById('pnlModify').style.display = "block";
            document.getElementById("listAgente").style.display = "none";

        }

        function registrarAgente() {
            document.getElementById("listAgente").innerHTML = "";          

            var agenteOb = {nombre : document.getElementById("txtNombreAgente").value,
                apPat :document.getElementById("txtApPatAgente").value,
                apMat : document.getElementById("txtApMatAgente").value,
                genre: document.getElementById("genreBox").options[0].value,
                date: document.getElementById("dateNac").value
            };
        

            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange= function () {
                if (ajax.readyState== 4 && ajax.status==200){
                    document.getElementById("msg").innerHTML = ajax.responseText;
                }
            };

            ajax.open("GET", "../php/sendAgente.php?b=" + JSON.stringify(agenteOb), true);
            ajax.send();
        }


        function buscarAgente() {
            document.getElementById("listAgente").innerHTML = "";


            var ajax = new XMLHttpRequest();

            var nombre= document.getElementById("id_agente").value;

            ajax.onreadystatechange = function () {
                if (ajax.readyState == 4 && ajax.status == 200) {
                    document.getElementById("listLugar").style.display = "block";
                    document.getElementById("listLugar").innerHTML = ajax.responseText;
                }
            };


            ajax.open("GET", "../php/buscarLugares.php?bar=" + nombre, true);
            ajax.send();

        }


        function buscarAgenteM() {
            document.getElementById("listLugar").innerHTML = "";


            var ajax = new XMLHttpRequest();

            var nombre = document.getElementById("shcMod").value;

            ajax.onreadystatechange = function () {
                if (ajax.readyState == 4 && ajax.status == 200) {
                    document.getElementById("listLugar").style.display = "block";
                    document.getElementById("listLugar").innerHTML = ajax.responseText;
                }
            };


            ajax.open("GET", "../php/modifyLugares.php?bar=" + nombre, true);
            ajax.send();

        }



        function modifyLugar(a) {
            turnOnPnlAdd();
            document.getElementById("btnModify").style.display = "block";
            document.getElementById("btnSend").style.display = "none";



            document.getElementById("txtNombreLugar").value=a.nombre;
            document.getElementById("txtDescLugar").value = a.desc;
            document.getElementById("txtCostoLugar").value = a.costo;
            document.getElementById("txtCapacidadLugar").value = a.capacidad;


            document.getElementById("tbNum").style.display = "block";

            document.getElementById("tbNum").value = a.numero;

        }

        function updateLugar() {
            document.getElementById("listLugar").innerHTML = "";

            var numero = document.getElementById("tbNum").value;
            var nombre = document.getElementById("txtNombreLugar").value;
            var desc = document.getElementById("txtDescLugar").value;
            var costo = document.getElementById("txtCostoLugar").value;
           var capacidad = document.getElementById("txtCapacidadLugar").value;

            var ajax = new XMLHttpRequest();
            ajax.onreadystatechange = function () {
                if (ajax.readyState == 4 && ajax.status == 200) {
                    document.getElementById("msg").innerHTML = ajax.responseText;
                }
            };

            ajax.open("GET", "../php/updtLugares.php?nombre=" + nombre + "&desc=" + desc + "&costo=" + costo + "&capacidad=" + capacidad + "&num=" + numero, true);
            ajax.send();

            document.getElementById("tbNum").style.display = "none";

        }

    </script>

</body>
</html>