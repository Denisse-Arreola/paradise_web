
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../css/CSS_CLIENTE_LUGARES.css" type="text/css">
    <meta meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lugares y Salones - Paradise</title>
</head>
<body onload="lugaresList(); cargarOPE(); cargarOPTL();">
    <nav class="NavOficial">
        <img src="../img/logoOficial.png" alt="Logotipo" width="30%" class="logoNav" />

        <section class="pruebaMenu">
            <article class="pMT"><a href="../index.html" ;>INICIO</a></article>
            <article class="pMTx"><a href="HTML_QUIENES_SOMOS.html" ;>¿QUIÉNES SOMOS?</a></article>
            <article class="pMT3"><a href="HTML_LUGARES.html" ;>LUGARES Y SALONES</a></article>
            <article class="pMT2"><a href="construccion.html" ;>PROMOCIONES</a></article>
            <article class="pMTxt"><a href="HTML_SIGN_IN.html" ;>INICIAR SESION</a></article>
        </section>
        <br />
        <section class="barraBusqueda">
            <input type="text" id="searchterm" class="busqueda" placeholder="¿Qué estás buscando?" />
            <button type="button" id="search" class="boton">Buscar</button>
        </section>
        <br />

    </nav>
    <br />

    <main>
        <section class="secPrincipal">
                La ultima promoción o novedad
        </section>
        <br />

        <section class="lugLista">
            <section class="filtros">
                <br /><br /><h2>GENERA UNA BUSQUEDA</h2>
                <br /><br />
                      <form class="colorf">
                          <hr /><br />
                          <h5>CIUDAD</h5>
                          <select name="ciudad" id="ciudad" class="filtro" required>
                              <option value="na"></option>
                              <option value="and Municipio='TIJ'">Tijuana</option>
                              <option value="and Municipio='ESE'">Ensenada</option>
                              <option value="and Municipio='ROS'">Rosarito</option>
                              <option value="and Municipio='TEC'">Tecate</option>
                              <option value="and Municipio='MXL'">Mexicali</option>
                          </select>
                          <hr />
                          <br /><br />
                          <hr /><br />
                          <h5>LUGAR QUE ESTAS BUSCANDO</h5>
                          <select id="opsel" class="filtro">
                          </select>
                          <hr />
                          <br /><br />
                          <hr /><br />
                          <h5>PRESUPUESTO</h5>
                          <select id="precio" class="filtro">
                              <option value="na"></option>
                              <option value="order by Costo desc">Lo más Destacado</option>
                              <option value="order by Costo asc">Lo más económico</option>
                          </select>
                          <hr />
                          <br /><br />
                          <hr /><br />
                          <h5>INVITADOS</h5>
                          <select id="cap" class="filtro">
                              <option value="na"></option>
                              <option value="and Capacidad<100">Menor de 100 personas</option>
                              <option value="and Capacidad>=100 and Capacidad<=200">Entre 100 a 200 personas</option>
                              <option value="and Capacidad>=200 and Capacidad<=300">Entre 200 a 300 personas</option>
                              <option value="and Capacidad>=300 and Capacidad<=500">Entre 300 a 500 personas</option>
                              <option value="and Capacidad>500">Más de 500 personas</option>
                          </select>
                          <hr />
                          <br /><br />
                          <hr /><br />
                          <h5>ESPACIOS</h5><br />
                          <section id="espBox">
                          </section>
                          <br />
                          <hr />
                          <br /><br />



                          <input type="button" value="BUSCAR" class="botonf" onclick="searchSp()" />
                      </form>
            </section>
            <section class="lugares" id="lugares">
                Las lista de lugares
            </section>
        </section>

        <script>

            function lugaresList()
            {
                
                var ajax = new XMLHttpRequest();

                caso = 1;

                ajax.onreadystatechange = function () {
                    if (ajax.status == 200 && ajax.readyState == 4)
                    {
                        document.getElementById('lugares').innerHTML = ajax.responseText;
                    }
                }

                

                ajax.open("GET","../php/listaLugare.php?", true);
                ajax.send();
            }

            
            function cargarOPE()
            {

                var ajax = new XMLHttpRequest();
                caso = 1;

                ajax.onreadystatechange = function () {
                    if (ajax.status == 200 && ajax.readyState == 4) {
                        fillDataEsp(ajax.responseText);
                    }
                };

                ajax.open("get", "../php/filtrosLug.php?caso=" + caso, true);
                ajax.send();

            }

            function cargarOPTL()
            {

                var ajax = new XMLHttpRequest();
                caso = 2;

                ajax.onreadystatechange = function () {
                    if (ajax.status == 200 && ajax.readyState == 4) {
                        fillDataTl(ajax.responseText);
                    }
                };

                ajax.open("get", "../php/filtrosLug.php?caso=" + caso, true);
                ajax.send();

            }

            function fillDataEsp(ob)
            {
                var y=0;
                var arrayEspacios = JSON.parse(ob);

                var espSection = document.getElementById("espBox");

               

                var tabla = document.createElement("table");
                tabla.className="tablaBox";

                espSection.appendChild(tabla);
                

                while (arrayEspacios[y])
                {

                    var ckBox = document.createElement("input");
                    ckBox.setAttribute("type", "checkbox");
                    ckBox.setAttribute("class", "ckB");
                    ckBox.style.marginRight = "50px";

                    ckBox.value = arrayEspacios[y].num;

                    var lbl = document.createElement("Label");
                    lbl.innerHTML = arrayEspacios[y].nombre;

                    var td = document.createElement("td");
                    var tr = document.createElement("tr");

                    td.appendChild(ckBox);
                    td.appendChild(lbl);
                    
                    tr.appendChild(td);
                    tabla.appendChild(tr);

                    
                    y++;
                }
            }

            function fillDataTl(ob)
            {
                var y=0;
                var arrayEspacios = JSON.parse(ob);

                var tlSection = document.getElementById("opsel");


                while (arrayEspacios[y])
                {

                    var option = document.createElement("option");
                    //option.setAttribute("class", "opsel");
                    option.style.marginRight = "50px";

                    option.value = arrayEspacios[y].num;

                    option.innerHTML = arrayEspacios[y].nombre;

                    tlSection.appendChild(option);
                    y++;
                }
            }

            function searchSp()
            {
                espacios = document.getElementsByClassName("ckB");

                console.log(document.getElementById('opsel').value);

                objbuscar =
                {
                    ciudad: document.getElementById('ciudad').value,

                    tipoL: document.getElementById('opsel').value,

                    precios: document.getElementById('precio').value,

                    capacidad: document.getElementById('cap').value,

                    esp: new function ()
                    {
                        var a = 0;
                        this.arrayId = [];
                        while (espacios[a]) {
                            if (espacios[a].checked == true) {
                                this.arrayId.push(espacios[a].value);
                            }
                            a++;
                        }
                    }
                };

                var ajax = new XMLHttpRequest();

                caso = 3;

                ajax.onreadystatechange = function () {
                    if (ajax.status == 200 && ajax.readyState == 4) {
                        document.getElementById('lugares').innerHTML = ajax.responseText;
                    }
                }



                ajax.open("get", "../php/filtrosList.php?objbuscar=" + JSON.stringify(objbuscar), true);
                ajax.send();
            }
            
            function cerrar()
        {
            document.getElementById("error2").close();

        }


            //$_SERVER['PHP_SELF'];


        </script>

    </main>

</body>
</html>