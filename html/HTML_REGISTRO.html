
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../css/CSS_CLIENTE_REGISTRO.css" type="text/css">
    <meta meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Paradise - Registro</title>

    <script src="../js/session.js"></script>
</head>
<body onload="sesion();">

    <nav>
        <img src="../img/logoOficial.png" alt="Logotipo" width="30%" class="logoNav" />

        <section class="pruebaMenu">
            <article class="pMT"><a href="../index.html" ;>INICIO</a></article>
            <article class="pMTx"><a href="HTML_QUIENES_SOMOS.html" ;>¿QUIÉNES SOMOS?</a></article>
            <article class="pMT3"><a href="HTML_LUGARES.html" ;>LUGARES Y SALONES</a></article>
            <article class="pMT2"><a href="construccion.html" ;>PROMOCIONES</a></article>
            <article class="pMTxt" id="log"><a href="HTML_LOG_IN.html" ;>INICIAR SESION</a></article>

            <article class="pMTxt1" id="login" style="display:none;"><a href="HTML_SIGN_IN.html";>
                <a href="../html/construccion.html" ;><img src="../img/Loto_paradise.png" width="45%;" />&nbsp;&nbsp;&nbsp;&nbsp;</a>
                <a href="../php/actions/session_out.php" ;><img src="../img/log_out.png" width="25%;" /></a>
            </article>

        </section>
        <br />
        <section class="barraBusqueda">
            <input type="text" id="searchterm" class="busqueda" placeholder="¿Qué estás buscando?" />
            <button type="button" id="search" class="boton">Buscar</button>
        </section>
    </nav>


                    

    <main>


        <section class="secS"></section>
            <section class="secMargin">
                <br /><br />
                <img alt="Paradise Logo" src="../img/logoOficial.png" width="60%"/>
                <br />
                <h3>CALIDAD Y BUENOS RECUERDOS</h3>
                <br />
                <h4>REGISTRATE</h4>
                <br />
                <section>
                    <form> <!--action="../php/config.php" method="post"-->
                        <table class="registrar">
                            <tr>
                                <th class="ins1"><label>Nombre: </label></th>
                                <th class="ins2"><input class="formInput" name="txtNombre" type="text" maxlength="30" id="txtNombre"  required /></th>
                            </tr>
                            <tr>
                                <th class="ins1"><label>Apellido Paterno: </label></th>
                                <th class="ins2"><input class="formInput" name="txtApPat" type="text" maxlength="30" id="txtApPat" required /></th>
                            </tr>
                            <tr>
                                <th class="ins1"><label>Apellido Materno: </label></th>
                                <th class="ins2"><input class="formInput" name="txtApMat" type="text" maxlength="30" id="txtApMat" /></th>
                            </tr>
                            <tr>
                                <th class="ins1"><label>Fecha de nacimiento:&nbsp;</label></th>
                                <th class="ins2"><input class="formInput" name="txtFecNac" type="date" id="txtFecNac" required><br /></th>
                            </tr>
                            <tr>
                                <th class="ins1"><label>Número de Teléfono: </label></th>
                                <th class="ins2"><input class="formInput" name="txtTelefono" type="tel" id="txtTelefono" required /></th>
                            </tr>
                            
                            <tr><th><br /><br /></th></tr>
                            <tr>
                                <th class="ins1"><label>Correo Electrónico: </label></th>
                                <th class="ins2"><input class="formInput" name="txtCorreo" type="email" maxlength="30" id="txtCorreo" required /></th>
                            </tr>
                                                        <tr>
                                <th class="ins1"><label>Usuario:&nbsp;</label></th>
                                <th class="ins2"><input class="formInput" name="txtUsuario" type="text" id="txtUsuario" pattern="[A-Za-z0-9._%+-]{6,}" title="Puede contener números, letras en mayúsculas y minusculas" required ><br /></th>
                            </tr>
                            <tr>
                                <th class="ins1"><label>Contraseña:&nbsp;</label></th>
                                <th class="ins2"><input class="formInput" name="txtPass" type="password" id="txtPass" pattern="[A-Za-z0-9._%+-]{6,}" title="Minimo 6 caracteres" required><br /></th>
                            </tr>
                            <tr>
                                <th class="ins1"><label>Confirmar Contraseña:&nbsp;</label></th>
                                <th class="ins2"><input class="formInput" name="txtConfiPass" type="password" id="txtConfiPass" pattern="[A-Za-z0-9._%+-]{6,}" title="Confirma la contraseña" required><br /></th>
                            </tr>
                            <!--CONFIRMAR QUE LA CONTRAEÑA SEA IGUAL EN AMBOS INPUT-->
                            <tr>
                                <th colspan="3" class="terminos">
                                    <br />
                                    <input type="checkbox" name="legal" id="legal" value="OK" required />
                                    &nbsp;Acepto que he leído y comprendido los siguientes Términos y Condiciones de Uso,
                                    y al hacer click en el recuadro, así como utilizar el presente
                                    servicio, dejo constancia expresa que los acepto de manera libre y consciente
                                    habiendo de mi parte revisado satisfactoriamente la información la cual considero
                                    adecuada y suficiente.
                                    <br /><br />
                                    Gracias por su preferencia.
                                </th>
                            </tr>
                            <tr><th colspan="3">&nbsp;<br />&nbsp;</th></tr>
                            <!--<tr><th><input type="submit" name="submit" value="Inscribirme" class="botonR"/><br />&nbsp;</th></tr>-->
                            <tr><th><input type="button" name="submit" value="Inscribirme" class="botonR" onclick="verifyForm()"/><br />&nbsp;</th></tr>
                            <tr><th colspan="3">&nbsp;<br />&nbsp;<br />&nbsp;</th></tr>
                        </table>
                    </form>

                     <dialog id="error" 
                             style="width:30%; height:10%; align-items:center; margin:auto; 
                             margin-top:-50%; background-color:rgb(3,95,108); color:white; text-align:center; 
                             padding:4%; font-family:Arial; font-size:larger;  ">
                         <p id="mensaje"></p><br />
                         <input type="button"  onclick="cerrar()" value="Cerrar"/>
                     </dialog>

                </section> 
                <!--<section id="inscrito"></section>-->             
            </section>
    </main>

    <script>

        function verifyForm() {
            
            //Variable para verificar una variable sin espacios
            var snEspacio = /\s/;
            //Variable que me autoriza si todo se encuentra correcto
            var confirmar = true;
            //Variable con el id del dialogo de error
            var dialogo = document.getElementById('error');
            
            var dato1 = document.getElementById('txtNombre').value;
            var dato2 = document.getElementById('txtApPat').value;
            var dato3 = document.getElementById('txtApMat').value;          //este campo puede estar vacio
            var dato4 = document.getElementById('txtFecNac').value;
            var dato5 = document.getElementById('txtTelefono').value;       //este campo puede estar vacio
            var dato6 = document.getElementById('txtCorreo').value;
            var dato7 = document.getElementById('txtUsuario').value;
            var dato8 = document.getElementById('txtPass').value;
            var dato9 = document.getElementById('txtConfiPass').value;

            // Posibles condicionales de verificación
            //dato1==''     ||  snEspacio.test(dato1)    ||     dato1.length < 2     ||     isNaN(dato1)
            //verificar        //verificar si encuentra     //verificarun minimo     //verificar que no sea numero 
            //si esta vacio    //espacio                   

            if (dato9=='' || snEspacio.test(dato9) || dato9.length < 8)
            {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Favor de confirmar su contraseña';}

            if (dato8=='' || snEspacio.test(dato8) || dato8.length < 8)
            {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Favor de colocar su constraseña, sin espacios, con al menos 8 caracteres';}

            if (dato8 != dato9) {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Verifique que las contraseñas coincidan';}

            if (dato7=='' || snEspacio.test(dato7) || dato7.length < 8 || isNaN(dato7) == false)
            {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Favor de colocar su nombre de usuario, sin espacios, al menos 8 caracteres y con al menos 1 letra';}

            if (dato6 == '' || snEspacio.test(dato6))
            {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Favor de colocar su correo electrónico sin espacios';}

            if (dato4=='')
            {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Favor de colocar su fecha de nacimiento';}

            //if (isNaN(dato3))   // == false
            //{
            //    confirmar = false;
            //    document.getElementById('mensaje').innerHTML = '';
            //    document.getElementById('mensaje').innerHTML = 'Favor de no colocar numeros en el campo apellido materno ';} 

            if (dato2 == '' || dato2.length < 2 || isNaN(dato2) == false) //
            {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Favor de llenar el campo apellido paterno (sin ingresar números)';}

            if (dato1 == '' || dato1.length < 2 || isNaN(dato1) == false)
            {
                confirmar = false;
                document.getElementById('mensaje').innerHTML = '';
                document.getElementById('mensaje').innerHTML = 'Favor de llenar el campo nombre (sin ingresar números)';}
            

            if (confirmar == false) {                       //En esta sección verificamos que todos los datos se encuentren correctos
                dialogo.showModal();                        //si encuentra un solo error, despliega un dialogo con el mensaje de error
            } else {                                                                    
                registrarUS(dato1, dato2, dato3, dato4, dato5, dato6, dato7, dato8);    
            }   //Una vez que todo esta verificado y correcto, enviamos los parametros a la función
            
                

            
        }

        function registrarUS(d1,d2,d3,d4,d5,d6,d7,d8)
        {
            var dialogo = document.getElementById('error');

            //Generamos un objeto con los datos proporcionados por el usuario
            
            newUserObj = {
                nombre: d1,
                paterno: d2,
                materno: d3,
                nacimiento: d4,
                telefono: d5,
                correo: d6,
                usuario: d7,
                contrasenia: d8
            }

                var ajax = new XMLHttpRequest();
                ajax.onreadystatechange = function () {
                    if (ajax.readyState == 4 && ajax.status == 200) {
                        document.getElementById('mensaje').innerHTML = '';
                        document.getElementById('mensaje').innerHTML = ajax.responseText;
                         dialogo.showModal();
                    }
            };
            ajax.open("GET", "../php/actions/registrarUser.php?obj=" + JSON.stringify(newUserObj), true);
            ajax.send();
            
        }

        //function confirmar()
        //{
        //    document.getElementById('dialogo1').style.display = "none";
        //}


        function cerrar()
        {
            document.getElementById("error").close();
            location.reload();
            //document.getElementById("error2").close();
            
        }

    </script>
</body>
</html>

